---
layout: page-with-sidebar
title:  "调优"
date:   2023-10-13 14:47:03 +0800
author: reflectt6
categories: "运维"
mainTag: "运维"
secondaryTag: ""
---

## 调优思路

- 调优一般都有针对性，例如对于a任务属于调优而对于b任务可能没用
- 调优前，针对任务找到瓶颈。这里需要用到性能监视软件，例如top、perf top、nmon、arthas（阿里开源的java性能监视工具）等。
- 针对业务分析瓶颈点

## 调优工具

不掌握工具是不可能做到调优的，这一节慢慢积累性能工具的使用。

调优工具按监控内容分类，可以分为cpu、内存、网络、磁盘等。细化到cpu，又可以分为进程级、线程级等。掌握对应的工具，才能快速定位性能问题。

其次对于业务的理解也很重要，知道在业务哪里打断点，知道要监控哪里，可以细粒度的得到瓶颈点。

### top

#### 资料

[top字段解析](https://zhuangjinjin.github.io/2019/Linux-Top%E5%91%BD%E4%BB%A4%E8%A7%A3%E6%9E%90/)

[top交互解析](https://mp.weixin.qq.com/s?__biz=MjM5Nzk1NzI2MQ==&mid=2649353992&idx=2&sn=cf1fbd3e13742cd55a5db6037bc27be0&chksm=becf54ea89b8ddfceb0c6dd9aa3fe46d8225b2b69ae62f6e2c58c593d0266f23b08ae8d61828&scene=27)

[比较详细的外文资料](https://man7.org/linux/man-pages/man1/top.1.html)

#### 参数

```shell
-d：number代表秒数，表示top命令显示的页面更新一次的间隔。默认是5秒。
-b：以批次的方式执行top。
-n：与-b配合使用，表示需要进行几次top命令的输出结果。
-p：指定特定的pid进程号进行观察。
-u：指定用户
-i：显示idle程序
```

#### 交互式

```shell
?：显示在top当中可以输入的命令 
P：以CPU的使用资源排序显示 
M：以内存的使用资源排序显示 
N：以pid排序显示 
T：由进程使用的时间累计排序显示 
k：给某一个pid一个信号。可以用来杀死进程 
r：给某个pid重新定制一个nice值（即优先级） 
q：退出top（用ctrl+c也可以退出top）
1：在top基本视图中，按键盘数字“1”可以监控每个逻辑CPU的状况
b：敲击键盘‘b’（打开关闭加亮效果）
x：敲击键盘‘x’（打开/关闭排序列的加亮效果）
f：编辑基本视图中的显示字段
```



## 压力测试

有时候为了确定到底是业务的问题，还是硬件的问题，需要对硬件进行压力测试。

同样，压力测试也要掌握相应的工具。

例如：hbase pe













