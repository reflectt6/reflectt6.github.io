---
layout: page-with-sidebar
title:  "æ€å™¨Docker"
date:   2024-03-20 9:47:03 +0800
author: reflectt6
categories: "è¿ç»´"
mainTag: "è¿ç»´"
secondaryTag: "é€Ÿé€šç¯å¢ƒ"
hideTag: false
---

## [Docker](https://docs.docker.com/manuals/)

[dockerfileæ–‡æ¡£](https://docs.docker.com/reference/dockerfile/)

dockerå¯ä»¥é€šè¿‡dockerfileè§„èŒƒã€å¯é€†çš„æ„å»ºæ ‡å‡†ç¯å¢ƒï¼Œä¹‹å‰å·²ç»äº†è§£è¿‡äº†ã€‚ä»Šå¤©çš„ä¸»é¢˜ä¸æ˜¯ä»–ã€‚



## [Docker Compose](https://docs.docker.com/compose/compose-file/)

ä»€ä¹ˆæ˜¯Docker Composeï¼Ÿå¯ä»¥å…ˆä»[è¿™ç¯‡æ–‡ç« ](https://www.freecodecamp.org/chinese/news/what-is-docker-compose-how-to-use-it/)å¦‚ä¸‹é—¨ã€‚

`docker-compose run` å’Œ `docker-compose up` æ˜¯ä¸¤ä¸ªä¸åŒçš„ Docker Compose å‘½ä»¤ï¼Œç”¨é€”å’Œè¡Œä¸ºä¹Ÿæœ‰æ‰€ä¸åŒï¼š

1. **docker-compose run**ï¼š
   - ç”¨é€”ï¼šç”¨äºåœ¨æŒ‡å®šæœåŠ¡çš„å®¹å™¨ä¸­è¿è¡Œç‰¹å®šå‘½ä»¤ã€‚
   - è¯­æ³•ï¼š`docker-compose run <service_name> <command>`
   - ç¤ºä¾‹ï¼š`docker-compose run web python manage.py migrate`
   - æ³¨æ„ï¼šä½¿ç”¨ `docker-compose run` æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨è¿è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œå‘½ä»¤æ‰§è¡Œå®Œæ¯•åå®¹å™¨ä¼šè¢«åœæ­¢å¹¶åˆ é™¤ã€‚é€‚åˆä¸´æ—¶æ€§çš„ä»»åŠ¡æ‰§è¡Œï¼Œå¦‚è¿è¡Œä¸€æ¬¡æ€§å‘½ä»¤æˆ–æµ‹è¯•ã€‚
2. **docker-compose up**ï¼š
   - ç”¨é€”ï¼šç”¨äºæ„å»ºå¹¶å¯åŠ¨æ•´ä¸ªåº”ç”¨çš„æœåŠ¡ã€‚
   - è¯­æ³•ï¼š`docker-compose up [options] [service...]`
   - ç¤ºä¾‹ï¼š`docker-compose up -d`ï¼ˆåœ¨åå°å¯åŠ¨æœåŠ¡ï¼‰
   - æ³¨æ„ï¼šä½¿ç”¨ `docker-compose up` æ—¶ï¼Œä¼šæ ¹æ® `docker-compose.yml` æ–‡ä»¶ä¸­çš„é…ç½®æ„å»ºé•œåƒå¹¶å¯åŠ¨å®¹å™¨ï¼Œå®¹å™¨ä¼šæŒç»­è¿è¡Œç›´åˆ°æ˜¾å¼åœæ­¢ã€‚é€‚åˆå¯åŠ¨åº”ç”¨çš„å¸¸é©»æœåŠ¡ã€‚

å› æ­¤ï¼Œä¸»è¦åŒºåˆ«åœ¨äº `docker-compose run` ç”¨äºè¿è¡Œä¸´æ—¶å‘½ä»¤ï¼Œè€Œ `docker-compose up` ç”¨äºå¯åŠ¨æ•´ä¸ªåº”ç”¨æœåŠ¡ã€‚



### [å®˜æ–¹æ•™ç¨‹](https://docs.docker.com/compose/compose-file/05-services/)

è¯´å®è¯ï¼Œçœ‹è¿™ç§è‹±æ–‡çš„æ–‡æ¡£æˆ‘çœŸæ˜¯æƒ³ğŸ¤®

docker-composeæœ‰V1å’ŒV2ä¸¤ä¸ªç‰ˆæœ¬ï¼Œ[ç›®å‰V1ç‰ˆæœ¬å·²ç»å¼ƒç”¨](https://docs.docker.com/compose/migrate/)ã€‚

ä¸€èˆ¬å°†é…ç½®ä¿¡æ¯å†™å…¥yamlæ–‡ä»¶ä¸­

- è¿è¡Œdocker-compose build [serverName] å°±ä¼šå»ymlæ‰¾åˆ°å¯¹åº”serverNameçš„æœåŠ¡ï¼Œç„¶åæ‰¾åˆ°buildé…ç½®è¿›è¡Œæ„å»º
- è¿è¡Œdocker-compose run [serverName] å°±ä¼šå»ymlæ‰¾åˆ°å¯¹åº”serverNameçš„æœåŠ¡ï¼Œç„¶åæ‰¾åˆ°commandé…ç½®è¿›è¡Œæ„å»ºï¼›ä¹Ÿå¯ä»¥docker-compose run [serverName] [command]ç›´æ¥æ‰§è¡Œå‘½ä»¤

è¿™é‡Œçœ‹çœ‹yamlæ–‡ä»¶åº”è¯¥æ€ä¹ˆå†™ï¼Œåƒserviceså°±æ˜¯é¡¶çº§å…ƒç´ ï¼ˆtop-level elementï¼‰ï¼Œ[è¿™é‡Œ](https://docs.docker.com/compose/compose-file/)å¯ä»¥çœ‹yamlä¸­æœ‰å“ªäº›é¡¶çº§å…ƒç´ ã€‚æ¯ä¸ªé¡¶çº§å…ƒç´ ç‚¹è¿›å»å¯ä»¥çœ‹æ¬¡çº§å±æ€§ã€‚

æ¯”å¦‚è¿™å°±æ˜¯ä¸€ä¸ªyamlæ–‡ä»¶ï¼Œserviceså±äºé¡¶çº§å…ƒç´ ï¼Œwebã€rediséƒ½æ˜¯æœåŠ¡çš„åç§°ä¹Ÿå°±æ˜¯ä¸Šé¢çš„ [serverName]

```yaml
services:
  web:
    build: .
    ports:
      - "8000:5000"
    volumes:
      - .:/code
    environment:
      FLASK_DEBUG: "true"
  redis:
    image: "redis:alpine"
```

æƒ³çœ‹çœ‹servicesé¡¶çº§å…ƒç´ ä¸‹æœ‰å“ªäº›æ¬¡çº§å±æ€§ï¼Œå¯ä»¥çœ‹[è¿™é‡Œ](https://docs.docker.com/compose/compose-file/05-services/)ã€‚

é™¤äº†servicesä¹‹å¤–ï¼Œè¿˜æœ‰versionã€nameã€networksã€volumnesã€configsã€secretså‡ ä¸ªé¡¶çº§å…ƒç´ 



## ç–‘é—®

1ã€ä¸ªäººå®è·µï¼šåœ¨windowsä¸Šè¿è¡Œubuntuçš„é•œåƒï¼Œç”¨äºç¼–è¯‘veloxï¼Œç¼–è¯‘éå¸¸æ…¢ã€‚

ä¸ç¡®å®šæ˜¯ä¸æ˜¯m1å’Œintel 11ä»£i9å·®ä¸å¤šï¼Ÿç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹ï¼Œå¥½åƒå·®ä¸å¤šã€‚ã€‚

è¿˜æ˜¯dockeræœ‰å¾ˆå¤šcpuæŸè€—ï¼Ÿ















